<div class="container-fluid sales-register">
  <div class="section user-details">
    <h3 class="section-title">Party Details / Invoices</h3>
    <div class="row">
      <div class="col-md-6">
        <label>Party Name</label>
        <input
          type="text"
          class="form-control"
          placeholder="Enter party name"
          [(ngModel)]="partyName"
          (input)="onPartyNameChange($event)"
        />
      </div>
      <div class="col-md-6">
        <label>Address</label>
        <input type="text" class="form-control" placeholder="Enter address"  [(ngModel)]="address"/>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-md-4">
        <label>Mobile</label>
        <input
        type="tel"
        id="mobile"
        class="form-control"
        placeholder="Enter mobile number"
        inputmode="numeric"
        maxlength="10"
        minlength="10"
        [(ngModel)]="mobile"
        required
        oninput="this.value=this.value.replace(/[^0-9]/g,'');"
        />
      </div>
   
      <div class="col-md-4">
        <label>Email</label>
        <input type="email" class="form-control" placeholder="Enter email" (change)="validateEmail($event)"  [(ngModel)]="email"/>
        
      </div>
      <div class="col-md-4">
        <label>Invoice Date</label>
        <div class="invoice-date-container">
          <input
            matInput
            class="form-control"
            [matDatepicker]="picker"
            [(ngModel)]="invoiceDate"
            placeholder="Select Date"
          />
          <mat-datepicker-toggle
            matSuffix
            [for]="picker"
          ></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
        </div>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-md-4">
        <label>GST No.</label>
        <input
          type="text"
          class="form-control"
          [value]="gstNo"
          [(ngModel)]="gstNo"
          placeholder="Enter GST number"
          readonly
        />
      </div>

      <div class="col-md-4">
        <label>Id Type</label>
        <select class="form-control"   [(ngModel)]="idType" >
          <option value="" disabled>Select ID</option>
          <option value="Aadhaar">Aadhaar</option>
          <option value="PAN">PAN</option>
          <option value="Driving License">Driving License</option>
          <option value="Voter ID">Voter ID</option>
          <option value="Passport">Passport</option>
        </select>
      </div>
      
      <div class="col-md-4">
        <label>Id No.</label>
        <input type="text" class="form-control" placeholder="Id No."  [(ngModel)]="idNumber"/>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-md-4">
        <label>Invoice No.</label>
        <input type="text" class="form-control" placeholder="#PR"   [value]="invoiceNo" [(ngModel)]="invoiceNo" readOnly/>
      </div>

      <div class="col-md-4">
        <label>Pay</label>
        <select class="form-control" [(ngModel)]="paymentType">
          <option value="" disabled>Select Type</option>
          <option value="PhonePe">PhonePe</option>
          <option value="GooglePay">GooglePay</option>
          <option value="Paytm">Paytm</option>
          <option value="DebitCard">DebitCard</option>
        </select>
      </div>
     
    </div>
  </div>
  <hr />

  <div class="section item-details">
    <h3 class="section-title">Item Details</h3>

    <div class="row item-row">
      <div class="col-md-4">
        <label>metal Type</label>
        <select class="form-control" [(ngModel)]="newItem.metalType" (change)="onMetalTypeChange()">
          <option value="" >Select Type</option>
          <option value="gold">Gold</option>
          <option value="silver">Silver</option>
        </select>
      </div>

      <div class="col-md-4 ">
        <label>Item Name</label>
        <input 
        type="text" 
        class="form-control" 
        [(ngModel)]="newItem.itemName" 
        placeholder="Enter Item Name" 
      />
      </div>
      <div class="col-md-4">
        <label>quantity</label>
        <input
          type="number"
          class="form-control"
          [(ngModel)]="newItem.quantity"
          min="0"
        />
      </div>
    </div>

    <div class="row mt-3">
      <div class="col-md-4">
        <label>Karat</label>
        <select class="form-control" [(ngModel)]="newItem.Karat" (change)="calculateKaratPrice()">
          <option value="" disabled>Select Type</option>
          <option *ngFor="let karat of karatValuePrice" [value]="karat.karat">{{ karat.karat }}</option>
        </select>
      </div>
      <div class="col-md-4">
        <label>Total Weight (gm)</label>
        <input
        type="number"
        class="form-control"
        [(ngModel)]="newItem.totalWeight"
        (input)="updatenetmetal()"
        min="0"
      />
      
      </div>
      <div class="col-md-4">
        <label>Stone</label>
        <input
          type="number"
          class="form-control"
          [(ngModel)]="newItem.Stone"
          (change)="calculateKaratPrice()"
          (input)="updatenetmetal()"
          min="0"
        />
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-md-4">
        <label>Stone Amt</label>
        <input
          type="text"
          class="form-control"
          [(ngModel)]="newItem.StoneAmt"
          (change)="calculateKaratPrice();"
          min="0"
        />
      </div>
      <div class="col-md-4">
        <label>Net Metal</label>
        <input type="number" class="form-control" [(ngModel)]="newItem.netmetal" [readonly]="true"  style="background-color: #e9ecef; cursor: not-allowed;"/>
      </div>
      <div class="col-md-4">
        <label>Product Price</label>
        <input
          type="text"
          class="form-control"
          [(ngModel)]="newItem.price"
          [readonly]="true"  style="background-color: #e9ecef; cursor: not-allowed;"
        />
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-md-4">
        <label>Discount</label>
        <input
          type="text"
          class="form-control"
          [(ngModel)]="newItem.discount"
          min="0"
        />
      </div>
      <div class="col-md-4">
        <label>SGST</label>
        <input type="text" class="form-control" [(ngModel)]="newItem.sgst" readonly  style="background-color: #e9ecef; cursor: not-allowed;"/>
      </div>
      
      <div class="col-md-4">
        <label>CGST</label>
        <input
          type="text"
          class="form-control"
          [(ngModel)]="newItem.cgst"
          readonly
          style="background-color: #e9ecef; cursor: not-allowed;"
        />
      </div>
      
      <div class="col-md-4">
        <label>Making charge</label>
        <input
          type="text"
          class="form-control"
          [(ngModel)]="newItem.makingcharge" readonly  style="background-color: #e9ecef; cursor: not-allowed;"
        />
      </div>
      
      <div class="col-md-4">
        <label>Total Value</label>
        <input
          type="text"
          class="form-control"
          [(ngModel)]="newItem.total"
          readonly  style="background-color: #e9ecef; cursor: not-allowed;"
        />
      </div>
    </div>

    <div class="col-md-12 text-right mt-3">
      <button class="btn btn-primary" (click)="addItem()">Add Item</button>
    </div>
  </div>

  <div class="section table-section" *ngIf="showTable">
    <h3 class="section-title">Items Table</h3>
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Invoice No</th>
          <!-- <th>Customer Name</th> -->
          <th>Item Name</th>
          <th>Quantity</th>
          <th>Total Weight</th>
          <th>Product Price</th>
          <th>Discount</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of items">
          <td>{{ invoiceNo }}</td>

          <td>{{ item.itemName }}</td>
          <td>{{ item.quantity }}</td>
          <td>{{ item.totalWeight }}</td>
          <td>{{ item.price }}</td>
          <td>{{ item.discount }}</td>
          <td>{{ item.total }}</td>
        </tr>
      </tbody>
    </table>
    <div class="col-md-12 text-right mt-3">
      <button class="btn btn-secondary" (click)="printBill()">Print Invoice</button>
      <button class="btn btn-warning" (click)="spilitBill()">Split Payment</button>
    </div>
  </div>


  <div class="section payment-details">
    <!-- Payment details fields here -->
  </div>
</div>

<div class="modal" [ngClass]="{ 'show': isPaymentModalOpen }">
  <div class="modal-content">
    <span class="close" (click)="closePaymentModal()">&times;</span>
    <h2>Payment Split</h2>

    <label for="paymentMode">Payment Mode</label>
    <select id="paymentMode" [(ngModel)]="paymentMode">
      <option value="full_cash">Full Cash</option>
      <option value="upi">UPI payment</option>
      <option value="metal_exchange">Metal Exchange</option>
    </select>

    <label for="amount">Amount</label>
    <div class="input-container">
      <input type="number" id="amount" [(ngModel)]="amount" placeholder="Enter Amount" />
      <span class="add-icon" (click)="saveAmount()">+</span>
    </div>
    <p class="red-text">spilit amount left: {{ pendingAmount }}</p>
    <!-- <button mat-raised-button color="primary" (click)="confirmPayment()">Confirm Payment</button> -->
  </div>
</div>


